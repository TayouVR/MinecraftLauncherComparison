---
const { launchers, values } = Astro.props as { launchers: LauncherDetails[], values: { identifier: string, value: string[] }[] };

const availableModloaders = [...new Set(values.flatMap(v => v.value))];

const niceLoaderNames = {
    "forge": ["Forge", "/src/assets/forge.svg"],
    "fabric": ["FabricMC", "/src/assets/fabric.png"],
    "quilt": ["QuiltMC", "/src/assets/quilt.svg"],
    "neoforge": ["Neoforge", "/src/assets/neoforged.png"],
    "legacy-fabric": ["Legacy Fabric", "/src/assets/legacy-fabric.png"],
    "liteloader": ["Lite Loader"],
    "rift": ["Rift Loader"],
    "risugami": ["Risugamis Modloader"],
}

function getLoaderIcon(platform: string) {
    const loaderData = niceLoaderNames[platform as keyof typeof niceLoaderNames];
    return loaderData && loaderData[1] ? loaderData[1] : "";
}

function getLoaderName(platform: string) {
    const loaderData = niceLoaderNames[platform as keyof typeof niceLoaderNames];
    return loaderData ? loaderData[0] : platform;
}
---
<tr><th colspan={launchers.length + 1}>Modloaders</th></tr>
{availableModloaders.map(modloader => (
<tr>
    <td class="modloader">
        { getLoaderIcon(modloader) != "" ?
                <img loading="lazy" alt={getLoaderName(modloader)} src={getLoaderIcon(modloader)} />
        : ""}
        <span>{getLoaderName(modloader)}</span>
    </td>
    { launchers.map(launcher => (
            <td class:list={[launcher.identifier, values.find(v => v.identifier === launcher.identifier)?.value.includes(modloader) ? 'yes' : 'no' ]}>
                { values.find(v => v.identifier === launcher.identifier)?.value.includes(modloader) ? 'Yes' : 'No' }
            </td>
    ))}
</tr>
))}

<style>
    .modloader {
        display: flex;
        flex-direction: row;
        justify-content: left;
        align-items: center;
        margin: 5px;
        height: 2em;
        overflow: hidden;
        gap: 10px;

        img {
            height: 2em;
            border-radius: 2px;
        }
        span {
            text-wrap: nowrap;
        }
    }
</style>